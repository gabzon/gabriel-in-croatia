---
import type { CollectionEntry } from 'astro:content';
import { Image } from 'astro:assets';
import { categoryConfig } from '../config/site';

interface Props {
  posts: CollectionEntry<'blog'>[];
}

const { posts } = Astro.props;
---

{posts.length > 0 && (
  <div>
    <h5 class="font-extrabold text-xs uppercase tracking-widest text-text-muted mb-4">
      Related Epiphanies
    </h5>
    <div class="space-y-4">
      {posts.slice(0, 3).map((post) => (
        <a href={`/blog/${post.slug}`} class="group block">
          <div class="flex gap-4">
            {post.data.heroImage && (
              <div class="w-16 h-16 rounded-lg overflow-hidden shrink-0">
                {typeof post.data.heroImage === 'string' ? (
                  <img
                    src={post.data.heroImage}
                    alt={post.data.title}
                    class="w-full h-full object-cover"
                  />
                ) : (
                  <Image
                    src={post.data.heroImage}
                    alt={post.data.title}
                    width={64}
                    height={64}
                    class="w-full h-full object-cover"
                  />
                )}
              </div>
            )}
            <div>
              <p class={`text-xs font-bold uppercase ${categoryConfig[post.data.category].textColor}`}>
                {categoryConfig[post.data.category].label}
              </p>
              <h6 class="text-sm font-bold leading-tight group-hover:text-primary transition-colors">
                {post.data.title}
              </h6>
            </div>
          </div>
        </a>
      ))}
    </div>
  </div>
)}
